import time #used to pause script execution steps
import win32con #used to cancel keypresses
import win32api #used to send keypresses
#script needs to be in the same directory as the emulator .exe or .bat file

def runCandCRedAlert():
    time.sleep(5)#waits for emu to start - very crude
    win32api.keybd_event(67, 0, 0, 0) # (C) presses the key - accepts unicode values
    time.sleep(0.1)#waits for emu to accept the key
    win32api.keybd_event(67, 0, win32con.KEYEVENTF_KEYUP, 0)#releases the key (C) - uses 'win32con.KEYEVENTF_KEYUP' to perform this
    win32api.keybd_event(68, 0, 0, 0,)# (D)
    time.sleep(0.1)
    win32api.keybd_event(68, 0, win32con.KEYEVENTF_KEYUP, 0)#release (D)
    win32api.keybd_event(32, 0, 0, 0)# (spacebar)
    time.sleep(0.1)
    win32api.keybd_event(32, 0, win32con.KEYEVENTF_KEYUP, 0)#release (spacebar)
    win32api.keybd_event(220, 0, 0, 0)  # (\)
    time.sleep(0.1)
    win32api.keybd_event(220, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (\)
    win32api.keybd_event(87, 0, 0, 0) #(W)
    time.sleep(0.1)
    win32api.keybd_event(87, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (W)
    win32api.keybd_event(69, 0, 0, 0) #(E)
    time.sleep(0.1)
    win32api.keybd_event(69, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (E)
    win32api.keybd_event(83, 0, 0, 0) #(S)
    time.sleep(0.1)
    win32api.keybd_event(83, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (S)
    win32api.keybd_event(84, 0, 0, 0) #(T)
    time.sleep(0.1)
    win32api.keybd_event(84, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (T)
    win32api.keybd_event(87, 0, 0, 0) #(W)
    time.sleep(0.1)
    win32api.keybd_event(87, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (W)
    win32api.keybd_event(79, 0, 0, 0) #(O)
    time.sleep(0.1)
    win32api.keybd_event(79, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (O)
    win32api.keybd_event(79, 0, 0, 0) #(O)
    time.sleep(0.1)
    win32api.keybd_event(79, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (O)
    win32api.keybd_event(68, 0, 0, 0) #(D)
    time.sleep(0.1)
    win32api.keybd_event(68, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (D)
    win32api.keybd_event(220, 0, 0, 0) #(\)
    time.sleep(0.1)
    win32api.keybd_event(220, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (\)

    win32api.keybd_event(82, 0, 0, 0) #(R)
    time.sleep(0.1)
    win32api.keybd_event(82, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (R)
    win32api.keybd_event(69, 0, 0, 0) #(E)
    time.sleep(0.1)
    win32api.keybd_event(69, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (E)
    win32api.keybd_event(68, 0, 0, 0) #(D)
    time.sleep(0.1)
    win32api.keybd_event(68, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (D)
    win32api.keybd_event(65, 0, 0, 0) #(A)
    time.sleep(0.1)
    win32api.keybd_event(65, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (A)
    win32api.keybd_event(76, 0, 0, 0) #(L)
    time.sleep(0.1)
    win32api.keybd_event(76, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (L)
    win32api.keybd_event(69, 0, 0, 0) #(E)
    time.sleep(0.1)
    win32api.keybd_event(69, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (E)
    win32api.keybd_event(82, 0, 0, 0) #(R)
    time.sleep(0.1)
    win32api.keybd_event(82, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (R)
    win32api.keybd_event(84, 0, 0, 0) #(T)
    time.sleep(0.1)
    win32api.keybd_event(84, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (T)
    win32api.keybd_event(220, 0, 0, 0) #(\)
    time.sleep(0.1)
    win32api.keybd_event(220, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (\)

    win32api.keybd_event(13, 0, 0, 0) #(Enter)
    time.sleep(0.1)
    win32api.keybd_event(13, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (Enter)
    
    win32api.keybd_event(82, 0, 0, 0) #(R)
    time.sleep(0.1)
    win32api.keybd_event(82, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (R)
    win32api.keybd_event(85, 0, 0, 0) #(U)
    time.sleep(0.1)
    win32api.keybd_event(85, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (U)
    win32api.keybd_event(78, 0, 0, 0) #(N)
    time.sleep(0.1)
    win32api.keybd_event(78, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (N)
    win32api.keybd_event(71, 0, 0, 0) #(G)
    time.sleep(0.1)
    win32api.keybd_event(71, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (G)
    win32api.keybd_event(65, 0, 0, 0) #(A)
    time.sleep(0.1)
    win32api.keybd_event(65, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (A)
    win32api.keybd_event(77, 0, 0, 0) #(M)
    time.sleep(0.1)
    win32api.keybd_event(77, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (M)
    win32api.keybd_event(69, 0, 0, 0) #(E)
    time.sleep(0.1)
    win32api.keybd_event(69, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (E)
    win32api.keybd_event(190, 0, 0, 0) #(.)
    time.sleep(0.1)
    win32api.keybd_event(190, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (.)
    win32api.keybd_event(69, 0, 0, 0) #(E)
    time.sleep(0.1)
    win32api.keybd_event(69, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (E)
    win32api.keybd_event(88, 0, 0, 0) #(x)
    time.sleep(0.1)
    win32api.keybd_event(88, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (x)
    win32api.keybd_event(69, 0, 0, 0) #(E)
    time.sleep(0.1)
    win32api.keybd_event(69, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (E)

    win32api.keybd_event(13, 0, 0, 0) #(Enter)
    time.sleep(0.1)
    win32api.keybd_event(13, 0, win32con.KEYEVENTF_KEYUP, 0)#releases (Enter)

runCandCRedAlert()

